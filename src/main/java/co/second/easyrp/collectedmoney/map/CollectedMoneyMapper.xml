<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="co.second.easyrp.collectedmoney.map.CollectedMoneyMapper">
	
	<!-- 테이블의 메인에 값을 깔기 위한 쿼리 START -->
	<select id="tableAllList"
		parameterType="co.second.easyrp.collectedmoney.service.SearchVO"
		resultType="co.second.easyrp.collectedmoney.service.CollectedMoneyVO">
		SELECT p.cod as 'cod', p.prodname as 'prodname', p2.name as
		'prodGroupName', w.name as 'warehouseName', p.cur_inv_qty as
		'curInvQty'
		FROM product p
		LEFT JOIN warehouse w ON p.warehouse_cod =
		w.cod
		LEFT JOIN productgroup p2 ON p.productgroup_cod = p2.cod
		WHERE
		p.deleteyn = 'N'
		<if test="searchOrderCod != null and searchOrderCod != ''">
			AND p.cod = #{searchOrderCod}
		</if>
		<if test="searchCollectedMoneyState != null and searchCollectedMoneyState != ''">
			AND p.prodname LIKE CONCAT('%', #{searchCollectedMoneyState}, '%')
		</if>
		<if
			test="searchWarehouseName != null and searchWarehouseName != ''">
			AND w.name LIKE CONCAT('%', #{searchWarehouseName}, '%')
		</if>
		<if
			test="searchProductGroupName != null and searchProductGroupName != ''">
			AND p2.name LIKE CONCAT('%', #{searchProductGroupName}, '%')
		</if>
		<if test="searchEmployeeCod != null and searchEmployeeCod != ''">
			AND p.employee_cod LIKE CONCAT('%', #{searchEmployeeCod}, '%')
		</if>
		ORDER BY p.cod DESC
		LIMIT #{pageSize} OFFSET #{offset}
	</select>
	<!-- 테이블의 메인에 값을 깔기 위한 쿼리 END -->

	<!-- 수주 정보를 CollectedMoney insert,update 페이지에서 쓰기 위한 쿼리 START  -->
	<select id="getHyunwooOrderData"
		resultType="co.second.easyrp.collectedmoney.service.CollectedMoneyVO">
		SELECT o.cod AS 'orderCod', o.total AS 'colsum', o.deleteyn AS 'deleteyn'
		FROM orders o
		WHERE deleteyn = 'N';
	</select>
		<!-- 수주 정보를 CollectedMoney insert,update 페이지에서 쓰기 위한 쿼리 END  -->
	
	
	
	<insert id="insertFn"
		parameterType="co.second.easyrp.collectedmoney.service.CollectedMoneyVO">
		INSERT INTO collectedmoney (
		order_cod,
		colsum,
		unrev,
		balance
		)
		VALUES(
		#{orderCod},
		#{colsum},
		#{unrev},
		#{balance}
		);
	</insert>

</mapper>